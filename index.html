<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pixel Runner Pro</title>
    <style>
        body { 
            margin: 0; padding: 0; overflow: hidden; 
            background: #87CEEB; font-family: 'Courier New', Courier, monospace;
            display: flex; justify-content: center; align-items: center; height: 100vh;
        }
        #gameContainer { position: relative; width: 800px; height: 300px; border-bottom: 5px solid #555; background: #fff; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        canvas { display: block; background: linear-gradient(#87CEEB, #E0F6FF); }
        #ui { position: absolute; top: 10px; left: 10px; font-weight: bold; font-size: 20px; color: #333; pointer-events: none; }
        #gameOver {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; display: none; background: rgba(255,255,255,0.9); padding: 20px; border-radius: 10px;
        }
        button { padding: 10px 20px; font-size: 18px; cursor: pointer; background: #ff4757; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>

    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <div id="ui">
            Score: <span id="score">0</span><br>
            High Score: <span id="highScore">0</span>
        </div>
        <div id="gameOver">
            <h1 style="color: #ff4757;">GAME OVER!</h1>
            <p>Aapka Score: <span id="finalScore">0</span></p>
            <button onclick="resetGame()">PLAY AGAIN</button>
        </div>
    </div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const highScoreEl = document.getElementById("highScore");
const finalScoreEl = document.getElementById("finalScore");
const gameOverEl = document.getElementById("gameOver");

// Setup Canvas Size
canvas.width = 800;
canvas.height = 300;

// Game Variables
let score = 0;
let highScore = localStorage.getItem("highScore") || 0;
highScoreEl.innerText = highScore;
let gameActive = true;
let frame = 0;

// Player Object
let player = {
    x: 50, y: 230, w: 40, h: 40,
    dy: 0, jumpForce: 13, gravity: 0.7,
    grounded: false,
    draw() {
        ctx.fillStyle = "#5d3fd3"; // Purple Pixel Character
        ctx.fillRect(this.x, this.y, this.w, this.h);
        // Eyes
        ctx.fillStyle = "white";
        ctx.fillRect(this.x + 25, this.y + 5, 8, 8);
    }
};

// Obstacles & Background
let obstacles = [];
let clouds = [];

function createObstacle() {
    let size = Math.random() * (50 - 20) + 20;
    obstacles.push({ x: canvas.width, y: canvas.height - size, w: 25, h: size });
}

// Sound Effects (Web Audio API)
function playSound(freq, type) {
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.1);
}

// Controls
function jump() {
    if (player.grounded && gameActive) {
        player.dy = -player.jumpForce;
        player.grounded = false;
        playSound(400, "square"); // Jump sound
    }
}

window.addEventListener("keydown", (e) => { if(e.code === "Space") jump(); });
canvas.addEventListener("touchstart", (e) => { e.preventDefault(); jump(); });

function update() {
    if (!gameActive) return;

    frame++;
    score++;
    scoreEl.innerText = Math.floor(score / 10);

    // Physics
    player.dy += player.gravity;
    player.y += player.dy;

    if (player.y + player.h > canvas.height) {
        player.y = canvas.height - player.h;
        player.dy = 0;
        player.grounded = true;
    }

    // Spawn obstacles
    if (frame % 100 === 0) createObstacle();

    obstacles.forEach((obs, i) => {
        obs.x -= 6 + (score/1000); // Speed increases slowly

        // Collision Check
        if (player.x < obs.x + obs.w && player.x + player.w > obs.x &&
            player.y < obs.y + obs.h && player.y + player.h > obs.y) {
            endGame();
        }

        if (obs.x + obs.w < 0) obstacles.splice(i, 1);
    });

    draw();
    requestAnimationFrame(update);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw Ground
    ctx.fillStyle = "#8B4513";
    ctx.fillRect(0, canvas.height - 5, canvas.width, 5);

    // Draw Player & Obstacles
    player.draw();
    ctx.fillStyle = "#ff4757";
    obstacles.forEach(obs => {
        ctx.fillRect(obs.x, obs.y, obs.w, obs.h);
    });
}

function endGame() {
    gameActive = false;
    playSound(150, "sawtooth"); // Game over sound
    if (score / 10 > highScore) {
        highScore = Math.floor(score / 10);
        localStorage.setItem("highScore", highScore);
    }
    finalScoreEl.innerText = Math.floor(score / 10);
    gameOverEl.style.display = "block";
}

function resetGame() {
    score = 0;
    obstacles = [];
    gameActive = true;
    gameOverEl.style.display = "none";
    update();
}

update();
</script>
</body>
</html>

